(window["webpackJsonptable-excel"]=window["webpackJsonptable-excel"]||[]).push([[0],{13:function(e,t,r){e.exports=r(24)},18:function(e,t,r){},24:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(6),l=r.n(c);r(18),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=r(2),u=r(4),i=r(12),s=r(1);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{values:{},loading:!1,current:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_TABLE":return f({},e,{},t.tableData);case"LOAD_TABLE":return f({},e,{loading:t.loading});case"CHANGE_TABLE_ELEM":return f({},e,{values:f({},e.values,Object(s.a)({},t.name,f({},e.values[t.name],{value:t.value,valueType:t.valueType})))});case"SET_CURRENT":return f({},e,{current:f({},e.current,{name:t.current,currency:t.currency})});case"CHANGE_CURRENCY":return f({},e,{values:f({},e.values,Object(s.a)({},t.name,f({},e.values[t.name],{currency:t.currency})))});default:return e}};function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{addressLine:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ADDRESS_LINE":return m({},e,{addressLine:t.addressLine});default:return e}},O=Object(u.c)({table:p,controls:d}),v=Object(u.d)(O,{},Object(u.a)(i.a)),g=new RegExp(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi),w=Object(n.memo)((function(e){var t=e.rowIndex,r=e.letter,n=e.value,c=e.isCurrent,l=e.currency,o=e.handleChangeTableElement,u=e.setCurrentTableElement,i=e.isCurrentTableColl,s=e.name,b=e.valueType,f=e.doJobWithFormula,p=e.changeTableElemValueCurrency,y=e.currencyList,m=l?function(e,t){var r=Number(e).toFixed(2),n=String(r).slice(-3);return String(r).slice(0,-3).split("").reverse().reduceRight((function(e,t,r){return e+((r+1)%3===0&&r?" "+t:t)}),"")+n+" "+t}(n,l):"",d="".concat(c&&t?"cell--current":t?"cell":"cell cell__ttl"," ").concat(i?"cell__ttl--highlight":"");return a.a.createElement("td",{className:d,onClick:function(){f(n,s,b),u(s,l)}},t?a.a.createElement("div",{className:"cell__content",title:l===y[0]?n:m},!l||c||l===y[0]?a.a.createElement("input",{className:"cell__field ".concat(b),value:n,name:s,onChange:o}):m,"number"===b&&c&&a.a.createElement("div",{className:"cell__currency",onClick:function(){var e=y||["num"],t=e.findIndex((function(t){return(l||e[0])===t})),r=t===e.length-1?e[0]:e[t+1];p(s,r)}},l||y[0])):r)})),h=function(e){return e.table.values},E=function(e){return e.table.loading},j=function(e){return e.table.alphabet},P=function(e){return e.table.rows},_=function(e){return e.table.current.name},T=function(e){return e.table.currencyList},C=function(e,t){return{type:"CHANGE_TABLE_ELEM",name:e,value:t,valueType:g.test(t)?"url":1*+t?"number":"string"}};function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var L=Object(o.b)((function(e,t){var r="".concat(t.letter).concat(t.rowIndex),n=_(e),a=!(!n||0!==t.rowIndex)&&n[0]===t.letter;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({tableValue:h(e)[r],isCurrent:_(e)===r,isCurrentTableColl:a,name:r,currencyList:T(e)},t)}),{handleChangeTableElement:function(e){var t=e.target,r=t.name,n=t.value;return C(r,n)},setCurrentTableElement:function(e,t){return function(r,n){(!n().controls.addressLine||!n().table.current)&&r({type:"SET_CURRENT",current:e,currency:t})}},doJobWithFormula:function(e,t,r){return function(n,a){var c=a(),l=c.table,o=l.current,u=l.values,i=c.controls.addressLine;if(o.name&&o.name!==t&&i.startsWith("=sum")){if("number"===r&&u[t]){var s=C(o.name,+(u[o.name]?u[o.name].value:0)+ +e);o.currency&&o.currency===u[t].currency?n(s):!o.currency&&!u[t].currency||"NUM"===!u[t].currency?n(s):alert("Wrong currency type")}else i.startsWith("=sum")&&alert("Cannot be added");if(i.startsWith("=concat")&&(e?n(C(o.name,(u[o.name]?u[o.name].value:"")+e)):alert("Cannot be collected")),o.name&&o.name!==t&&i.startsWith("=average")){if(!o.currency)return void alert("Forbidden");if(i.startsWith("=average")&&"number"===r&&u[t]){var b=C(o.name,(+(u[o.name]?u[o.name].value:e)+ +e)/2);o.currency&&o.currency===u[t].currency?n(b):!o.currency&&!u[t].currency||"NUM"===!u[t].currency?n(b):alert("Wrong currency type")}else alert("Cannot be compared")}}}},changeTableElemValueCurrency:function(e,t){return{type:"CHANGE_CURRENCY",name:e,currency:t}}})((function(e){var t=e.tableValue,r=t?t.value:"",n=t?t.valueType:null,c=t?t.currency:null;return a.a.createElement(w,Object.assign({},e,{value:r,valueType:n,currency:c}))})),N=Object(n.memo)((function(e){var t=e.rowIndex,r=e.alphabet,n=e.isCurrentTableRow;return a.a.createElement("tr",null,a.a.createElement("td",{className:"".concat(t?"cell cell__ttl":""," ").concat(n?"cell__ttl--highlight":"")},t||""),r&&r.map((function(e){return a.a.createElement(L,Object.assign({key:"".concat(e).concat(t)},{rowIndex:t,letter:e}))})))}));function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var S=Object(o.b)((function(e,t){var r=_(e);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isCurrentTableRow:!!r&&+r.slice(1)===+t.rowIndex},t)}),{})((function(e){return a.a.createElement(N,e)})),R=function(e){var t=e.current,r=e.addressLine,n=e.setAddressLine,c=e.currentType;return a.a.createElement("div",{className:"controls"},a.a.createElement("div",{className:"controls__address-line-container"},"fx",a.a.createElement("input",{className:"controls__address-line",onChange:function(e){var t=e.target;return n(t.value)},placeholder:"url"===c?"=HYPERLINK(".concat(t,")"):t,value:r})))};function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var k=Object(o.b)((function(e,t){var r=_(e),n=function(e){return e.controls.addressLine}(e),a=h(e)[r];return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(r,!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{current:r,currentType:a?a.valueType:null,addressLine:n})}),{setAddressLine:function(e){return function(t){"=sum"===e&&t({formula:e,type:"SET_CURRENT_FORMULA"}),t({type:"SET_ADDRESS_LINE",addressLine:e})}}})((function(e){return a.a.createElement(R,e)})),I=function(e){var t=e.alphabet,r=e.rows,n=new Array(r).fill(null);return a.a.createElement("div",{className:"table-page"},a.a.createElement(k,null),a.a.createElement("div",{className:"table-page__table-container"},a.a.createElement("table",{className:"table-page__table"},a.a.createElement("thead",null,n.map((function(e,r){return a.a.createElement(S,{key:r,rowIndex:r,alphabet:t})}))))))},W=Object(o.b)((function(e){return{loading:E(e),alphabet:j(e),rows:P(e)}}),{fetchTable:function(){return function(e){fetch(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/table-excel".concat("/");return e.startsWith("http")?e:t.concat(e)}("index.json")).then((function(e){return e.json()})).then((function(t){e({type:"FETCH_TABLE",tableData:t})}))}}})((function(e){var t=e.fetchTable,r=e.loading,c=e.alphabet,l=e.rows;return Object(n.useEffect)(t,[]),r?a.a.createElement("div",null,"Loading..."):a.a.createElement(I,{alphabet:c,rows:l})}));l.a.render(a.a.createElement(o.a,{store:v},a.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.45340914.chunk.js.map